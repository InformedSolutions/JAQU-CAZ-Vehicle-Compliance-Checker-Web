= javascript_pack_tag 'moj'

- title_and_header = 'Clean Air Zone charge'
= content_for(:title, title_and_header)
= back_link(session[:possible_fraud] ? confirm_uk_details_vehicle_checkers_path : confirm_details_vehicle_checkers_path)

%main.govuk-main-wrapper#main-content{role: 'main'}
  .govuk-grid-row
    .govuk-grid-column-two-thirds
      %h1.govuk-heading-l= title_and_header
      %p
        Results for number plate
        = succeed '.' do
          %strong= @vrn

      %div.scrollable-table
        %table.govuk-table#compliance-table
          %thead.govuk-table__head
            %tr.govuk-table__row
              %th.govuk-table__header{scope: 'col', 'aria-sort': 'ascending'}
                = button_tag 'Clean Air Zone', data: {index: 0}, type: 'button'
              %th.govuk-table__header{scope: 'col', 'aria-sort': 'none'}
                = button_tag 'Daily charge', data: {index: 1}, type: 'button'
              %th.govuk-table__header{scope: 'col', 'aria-sort': 'none'}
                = button_tag 'Charging starts', data: {index: 2}, type: 'button'
              %th.govuk-table__header{scope: 'col', 'aria-sort': 'none'}
                = button_tag 'Map', data: {index: 3}, type: 'button'
              %th.govuk-table__header{scope: 'col', 'aria-sort': 'none'}
                = button_tag 'Exemptions', data: {index: 4}, type: 'button'
          %tbody.govuk-table__body
            - @compliance_outcomes.each do |details|
              %tr.govuk-table__row
                %td.govuk-table__cell= details.zone_name
                %td.govuk-table__cell{ data: { 'sort-value': details.charge_amount } }
                  - if details.charged? && details.zone_name == 'Bath' && @phgv_discount_available
                    = details.charge
                    = link_to 'Discount available', details.exemption_or_discount_url
                  - elsif details.charged?
                    = details.charge
                  - else
                    = 'No Charge'                    
                %td.govuk-table__cell= details.charging_starts
                %td.govuk-table__cell
                  = link_to 'Zone boundary', details.boundary_url
                %td.govuk-table__cell
                  = link_to details.operator_name, details.exemption_or_discount_url

      - if @any_caz_chargeable
        %p
          %b If your vehicle is subject to a daily charge, you do not need to pay until charging starts.

      %p The zones will operate 24 hours a day, 7 days a week, every day of the year.

      %details.govuk-details{'data-module': 'govuk-details'}
        %summary.govuk-details__summary
          %span.govuk-details__summary-text
            How we calculate your charge
        .govuk-details__text
          %p We use this information when calculating your charge:
          %ul
            %li vehicle type
            %li emission standards
            %li Clean Air Zone (CAZ)
          %p
            For example:
            %br
            A private car (Euro 4) in Birmingham
            = surround('(', ')') do
              = link_to('CAZ D', 'https://www.gov.uk/guidance/driving-in-a-clean-air-zone#types-of-clean-air-zones')
            \= £8.00
            %br
            A private car (Euro 4) in Bath
            = surround('(', ')') do
              = link_to('CAZ C', 'https://www.gov.uk/guidance/driving-in-a-clean-air-zone#types-of-clean-air-zones')
            \= £0.00 (No charge)
          %p
            There are
            = link_to('4 categories', 'https://www.gov.uk/guidance/driving-in-a-clean-air-zone#types-of-clean-air-zones')
            of Clean Air Zone; each one charges different types of vehicle.
            For example, Birmingham charges private cars (CAZ D) but Bath does not (CAZ C).

      %h2.govuk-heading-m Important information about vehicle data
      %p
        The data accuracy of this service is always improving. If you think the charge result you have
        received is incorrect contact us.

      %h2.govuk-heading-m Guidance on Clean Air Zones
      %p
        You can find out more about national exemptions, different types of Clean Air Zones and emission
        standards on our
        = succeed '.' do
          = link_to 'guidance page', 'https://www.gov.uk/guidance/driving-in-a-clean-air-zone'

      %h2.govuk-heading-m Sustainable travel
      %p Local authorities in the Clean Air Zones have specific information on:
      %ul.govuk-list.govuk-list--bullet
        %li support to upgrade or replace your vehicle
        %li cycling and public transport options

      = render 'go_ultra_low_icon'
      = render 'common/print_page'

    .govuk-grid-column-one-third
      %aside#related-items-label.app-related-items{role: 'complementary'}
        %h2.govuk-heading-m
          Related tasks
        %nav{'aria-labelledby': 'related-items-label', role: 'navigation'}
          %ul.govuk-list{class: 'govuk-!-font-size-16'}
            %li
              = link_to 'Check another vehicle',
                        enter_details_vehicle_checkers_path,
                        id: 'check-another-vrn-url'
            %li
              = link_to('Contact Clean Air Zones',
                         Rails.configuration.x.contact_form_link,
                         id: 'contact-form')
