= content_for(:title, "Which Clean Air Zone do you want to drive in?")
= link_to 'Back', confirm_details_vehicle_checkers_path, class: 'govuk-back-link'

%main.govuk-main-wrapper#main-content{role: 'main'}
  .govuk-grid-row
    .govuk-grid-column-two-thirds
      - if alert
        = render 'common/error_summary',
          error_msg_div: '#caz-selection-error',
          error_msg: alert

      = form_tag submit_caz_selection_air_zones_path, method: :post do
        .govuk-form-group{class: ('govuk-form-group--error' if alert)}
          %fieldset.govuk-fieldset{'aria-describedby': 'caz-hint'}
            %legend.govuk-fieldset__legend.govuk-fieldset__legend--l
              %h1.govuk-fieldset__heading
                Which Clean Air Zone do you want to drive in?
            %span#caz-hint.govuk-hint
              Select all locations that apply.
            - if alert
              %span#caz-selection-error.govuk-error-message
                %span.govuk-visually-hidden Error:
                = I18n.t('caz_selection_form.la_missing')
            .govuk-checkboxes
              - @clean_air_zones.each_with_index do |zone, index|
                .govuk-checkboxes__item
                  %input.govuk-checkboxes__input{name: 'caz[]',
                                                 type: 'checkbox',
                                                 value: zone.id,
                                                 id: "caz-#{index}",
                                                 checked: zone.checked?(@checked_zones)}
                  %label.govuk-label.govuk-checkboxes__label{for: "caz-#{index}"}
                    = zone.name
                    = external_link_to("(View a map of the #{zone.name} Clean Air Zone)",
                                       zone.boundary_url,
                                       id: "caz-#{index}-link")

        = submit_tag 'Continue',
                     class: 'govuk-button',
                     'data-module': 'govuk-button',
                     id: 'submit_caz_selection_button'
